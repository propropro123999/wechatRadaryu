<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å£¹ä¼´æ•°æ®åˆ†æå·¥å…·ï¼ˆæœ¬åœ°ç‰ˆï¼‰</title>
  <link rel="stylesheet" href="ui.css" />
  <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    /* ===== é¡µé¢ç‰¹å®šæ ·å¼ ===== */
    #app {
      display: none;
      min-height: 100vh;
    }

    #app.visible {
      display: block;
    }

    #loading, #error {
      padding: var(--space-4);
      margin-bottom: var(--space-6);
      border-radius: var(--radius-md);
      font-size: 14px;
    }

    #loading {
      background: var(--color-primary-bg);
      color: var(--color-primary);
    }

    #error {
      background-color: var(--color-error-bg);
      color: var(--color-error);
    }

    /* æ±‡æ€»å¡ç‰‡ç½‘æ ¼ */
    .cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--space-4);
      margin-bottom: var(--space-8);
    }

    .card-label {
      font-size: 12px;
      color: var(--color-text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: var(--space-1);
      font-weight: 600;
    }

    .card-value {
      font-size: 28px;
      font-weight: 700;
      color: var(--color-text);
      line-height: 1.2;
    }

    .card-desc {
      font-size: 12px;
      color: var(--color-text-secondary);
      margin-top: var(--space-1);
    }

    /* å›¾è¡¨å— */
    .chart-block {
      background: var(--color-surface);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-lg);
      padding: var(--space-6);
      margin-bottom: var(--space-6);
    }

    .chart-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--color-text);
      margin-bottom: var(--space-2);
    }

    .chart-subtitle {
      font-size: 13px;
      color: var(--color-text-secondary);
      margin-bottom: var(--space-4);
    }

    .chart {
      min-height: 320px;
      width: 100%;
    }

    /* h2 æ ·å¼ */
    .section-title {
      font-size: 18px;
      margin-top: var(--space-8);
      margin-bottom: var(--space-6);
      padding-top: var(--space-6);
      border-top: 1px solid var(--color-border);
      color: var(--color-text);
    }

    .section-title:first-of-type {
      border-top: none;
      margin-top: 0;
      padding-top: 0;
    }

    .footer {
      text-align: center;
      margin-top: var(--space-8);
      padding-top: var(--space-6);
      border-top: 1px solid var(--color-border);
      font-size: 12px;
      color: var(--color-text-tertiary);
    }

    /* æ•°æ®è¡¨æ ¼æ ·å¼ */
    .data-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }

    .data-table th {
      background: var(--color-bg);
      padding: var(--space-3) var(--space-4);
      text-align: left;
      font-weight: 600;
      color: var(--color-text-secondary);
      border-bottom: 1px solid var(--color-border);
    }

    .data-table td {
      padding: var(--space-3) var(--space-4);
      border-bottom: 1px solid var(--color-border);
      color: var(--color-text);
    }

    .data-table tbody tr:hover {
      background: var(--color-bg);
    }

    /* å“åº”å¼ */
    @media (max-width: 768px) {
      .cards {
        grid-template-columns: 1fr;
      }

      .chart {
        min-height: 250px;
      }

      .chart-block {
        padding: var(--space-4);
      }
    }
  </style>
</head>

<body>
  <!-- æˆæƒå±‚ -->
  <div id="auth-screen">
    <div class="auth-card" id="auth-card">
      <h2>ğŸ” å£¹ä¼´æ•°æ®åˆ†æ</h2>
      <p>è¯·è¾“å…¥æˆæƒç è®¿é—®æœ¬å·¥å…·</p>

      <div class="form-group">
        <label class="form-label" for="auth-code">æˆæƒç </label>
        <input id="auth-code" class="input" type="text" placeholder="ä¾‹å¦‚ï¼šYB-2025-A1B2" autocomplete="off" />
      </div>

      <button class="btn btn-primary" id="auth-btn" style="width: 100%;">ç¡®è®¤è¿›å…¥</button>

      <div class="auth-error" id="auth-error"></div>
    </div>
  </div>

  <!-- çœŸæ­£çš„åº”ç”¨ -->
  <div id="app">
    <!-- å¯¼èˆªæ å®¹å™¨ -->
    <div id="nav-container"></div>

    <div class="container">
      <div class="mb-6">
        <h1>å£¹ä¼´æ•°æ®åˆ†æ</h1>
        <p class="text-muted">æ”¯æŒå£¹ä¼´æ’ä»¶å¯¼å‡ºçš„ Excel è¡¨æ ¼ï¼Œè‡ªåŠ¨è¯†åˆ«é˜…è¯»ã€åˆ†äº«ã€äº’åŠ¨ç­‰å­—æ®µ</p>
      </div>
      <div id="dateRange" class="flex items-center gap-3 mb-6 text-sm text-muted">
        è¯·å…ˆåœ¨ä¸Šæ–¹é€‰æ‹©å£¹ä¼´å¯¼å‡ºçš„ Excel æ–‡ä»¶
        <span class="badge badge-primary">ç¦»çº¿æœ¬åœ°åˆ†æ</span>
      </div>

      <div id="loading"></div>
      <div id="error"></div>

      <!-- æ±‡æ€»å¡ç‰‡ -->
      <div class="cards" id="summaryCards" style="display:none;">
        <div class="card">
          <div class="card-label">æ–‡ç« æ€»æ•°</div>
          <div class="card-value" id="totalArticles">-</div>
          <div class="card-desc">ç»Ÿè®¡å‘¨æœŸå†…çš„æ–‡ç« æ•°é‡</div>
        </div>
        <div class="card">
          <div class="card-label">æ€»é˜…è¯»äººæ•°</div>
          <div class="card-value" id="totalReaders">-</div>
          <div class="card-desc">ç´¯è®¡é˜…è¯»äººæ•°</div>
        </div>
        <div class="card">
          <div class="card-label">æ€»é˜…è¯»é‡</div>
          <div class="card-value" id="totalReadCount">-</div>
          <div class="card-desc">ç´¯è®¡é˜…è¯»æ¬¡æ•°</div>
        </div>
        <div class="card">
          <div class="card-label">æ€»åˆ†äº«é‡</div>
          <div class="card-value" id="totalShareCount">-</div>
          <div class="card-desc">ç´¯è®¡åˆ†äº«æ¬¡æ•°</div>
        </div>
        <div class="card">
          <div class="card-label">æ€»ç‚¹èµæ•°</div>
          <div class="card-value" id="totalLikes">-</div>
          <div class="card-desc">ç´¯è®¡ç‚¹èµæ•°</div>
        </div>
        <div class="card">
          <div class="card-label">æ–°å¢å…³æ³¨</div>
          <div class="card-value" id="totalFollows">-</div>
          <div class="card-desc">ç´¯è®¡æ–°å¢å…³æ³¨äººæ•°</div>
        </div>
        <div class="card">
          <div class="card-label">å¹³å‡æ‰“å¼€ç‡</div>
          <div class="card-value" id="avgOpenRate">-</div>
          <div class="card-desc">å¹³å‡æ‰“å¼€ç‡</div>
        </div>
        <div class="card">
          <div class="card-label">å¹³å‡åˆ†äº«ç‡</div>
          <div class="card-value" id="avgShareRate">-</div>
          <div class="card-desc">å¹³å‡åˆ†äº«ç‡</div>
        </div>
      </div>

      <!-- ä¸€ã€Top å†…å®¹è¡¨ç° -->
      <h2>ä¸€ã€Top å†…å®¹è¡¨ç°</h2>
      <div class="chart-block">
        <div class="chart-title">Top10 å†…å®¹ï¼ˆæŒ‰é˜…è¯»äººæ•°ï¼‰</div>
        <div id="topReadChart" class="chart"></div>
      </div>

      <div class="chart-block">
        <div class="chart-title">é˜…è¯»äººæ•° vs åˆ†äº«é‡</div>
        <div id="readShareScatter" class="chart"></div>
      </div>

      <!-- äºŒã€äº’åŠ¨åˆ†æ -->
      <h2>äºŒã€äº’åŠ¨è¡¨ç°</h2>
      <div class="chart-block">
        <div class="chart-title">ç‚¹èµæ•° Top10</div>
        <div id="topLikesChart" class="chart"></div>
      </div>

      <div class="chart-block">
        <div class="chart-title">åˆ†äº«é‡ Top10</div>
        <div id="topShareChart" class="chart"></div>
      </div>

      <!-- ä¸‰ã€è½¬åŒ–ç‡åˆ†æ -->
      <h2>ä¸‰ã€è½¬åŒ–ç‡åˆ†æ</h2>
      <div class="chart-block">
        <div class="chart-title">æ‰“å¼€ç‡åˆ†å¸ƒï¼ˆTop20ï¼‰</div>
        <div id="openRateChart" class="chart"></div>
      </div>

      <!-- å››ã€æ ¸å¿ƒæŒ‡æ ‡ TOP 5 åˆ†æ -->
      <h2>å››ã€æ ¸å¿ƒæŒ‡æ ‡ TOP 5 åˆ†æ</h2>

      <div class="chart-block">
        <div class="chart-title">é˜…è¯»é‡ TOP 5</div>
        <div class="chart-subtitle">åæ˜ æ•´ä½“çš„å†…å®¹é˜…è¯»ç»“æœæ•°æ®</div>
        <div id="topReadCountTable"></div>
      </div>

      <div class="chart-block">
        <div class="chart-title">æœä¸€æœ TOP 5</div>
        <div class="chart-subtitle">åæ˜ è¿™äº›å†…å®¹çš„æœç´¢å–œå¥½ç¨‹åº¦</div>
        <div id="topSearchTable"></div>
      </div>

      <div class="chart-block">
        <div class="chart-title">çœ‹ä¸€çœ‹ç²¾é€‰ TOP 5</div>
        <div class="chart-subtitle">åæ˜ å†…å®¹åœ¨æ¨èç³»ç»Ÿä¸­çš„å—å–œå¥½ç¨‹åº¦</div>
        <div id="topLookTable"></div>
      </div>

      <div class="chart-block">
        <div class="chart-title">åˆ†äº«é‡ TOP 5</div>
        <div class="chart-subtitle">åæ˜ ç”¨æˆ·å¯¹å†…å®¹çš„åˆ†äº«åŠ¨åŠ›</div>
        <div id="topShareCountTable"></div>
      </div>

      <div class="chart-block">
        <div class="chart-title">æ‰“å¼€ç‡ TOP 5</div>
        <div class="chart-subtitle">ç»¼åˆåæ˜ ç²‰ä¸çš„æ´»è·ƒåº¦ã€æ ‡é¢˜çš„å¸å¼•åŠ›ã€æ¨é€çš„æ—¶é—´èŠ‚ç‚¹æ˜¯å¦æ°å½“</div>
        <div id="topOpenRateTable"></div>
      </div>

      <div class="chart-block">
        <div class="chart-title">æœ‹å‹åœˆæ‰“å¼€ç‡ TOP 5</div>
        <div class="chart-subtitle">åæ˜ åˆ†äº«åçš„äºŒæ¬¡ä¼ æ’­èƒ½åŠ›</div>
        <div id="topMomentsOpenRateTable"></div>
      </div>

      <div class="chart-block">
        <div class="chart-title">ç•™è¨€ç‡ TOP 5</div>
        <div class="chart-subtitle">åæ˜ ç”¨æˆ·å¯¹å†…å®¹äº§ç”Ÿçš„äº’åŠ¨ç¨‹åº¦</div>
        <div id="topCommentRateTable"></div>
      </div>

      <div class="chart-block">
        <div class="chart-title">é˜…è¯»åå…³æ³¨ TOP 5</div>
        <div class="chart-subtitle">åæ˜ ç”¨æˆ·å¯¹å½“å‰é˜…è¯»å†…å®¹çš„æŒç»­å…³æ³¨åº¦</div>
        <div id="topFollowsTable"></div>
      </div>

      <!-- å…­ã€å†…å®¹æ˜ç»† -->
      <h2>äº”ã€å†…å®¹æ˜ç»†ï¼ˆTop50 æŒ‰é˜…è¯»äººæ•°ï¼‰</h2>
      <div class="chart-block">
        <div class="chart-title">å†…å®¹æ˜ç»†è¡¨</div>
        <div id="detailTable"></div>
      </div>

      <div class="footer" style="font-size:11px;color:#9ca3af;margin-top:24px;text-align:center;">
        æœ¬é¡µé¢ä»…åœ¨æœ¬åœ°æµè§ˆå™¨ä¸­å¤„ç†ä½ çš„ Excel æ•°æ®ï¼Œä¸ä¼šä¸Šä¼ åˆ°ç½‘ç»œã€‚
      </div>
    </div>
  </div>

  <script>
    const fileInput = document.getElementById("fileInput");
    const loadingEl = document.getElementById("loading");
    const errorEl = document.getElementById("error");

    fileInput.addEventListener("change", handleFile, false);

    function handleFile(e) {
      const file = e.target.files[0];
      if (!file) return;
      loadingEl.textContent = "æ­£åœ¨è¯»å–å¹¶è§£æ Excel æ•°æ®ï¼Œè¯·ç¨å€™â€¦";
      errorEl.textContent = "";

      const reader = new FileReader();
      reader.onload = function (evt) {
        try {
          const data = evt.target.result;
          const workbook = XLSX.read(data, { type: "array" });
          const firstSheet = workbook.SheetNames[0];
          const worksheet = workbook.Sheets[firstSheet];
          const json = XLSX.utils.sheet_to_json(worksheet, { defval: "" });
          processData(json);
          loadingEl.textContent = "";
        } catch (err) {
          console.error(err);
          errorEl.textContent = "è§£æ Excel å¤±è´¥ï¼Œè¯·ç¡®è®¤æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®ã€‚";
          loadingEl.textContent = "";
        }
      };
      reader.readAsArrayBuffer(file);
    }

    function num(v) {
      if (v === null || v === undefined || v === "") return 0;
      const s = String(v).replace(/,/g, "").replace(/%/g, "");
      const n = Number(s);
      return isNaN(n) ? 0 : n;
    }

    function pct(v) {
      if (!v) return 0;
      const s = String(v).trim();
      if (s.endsWith("%")) return parseFloat(s.slice(0, -1)) || 0;
      return parseFloat(s) || 0;
    }

    function parseDate(value) {
      if (!value) return null;
      if (value instanceof Date) return value;
      if (typeof value === "number") {
        return new Date(Math.round((value - 25569) * 86400 * 1000));
      }
      const d = new Date(value);
      if (isNaN(d.getTime())) return null;
      return d;
    }

    function formatDate(d) {
      if (!d) return "";
      const y = d.getFullYear();
      const m = String(d.getMonth() + 1).padStart(2, "0");
      const day = String(d.getDate()).padStart(2, "0");
      return `${y}-${m}-${day}`;
    }

    function findCol(candidates, cols) {
      // å…ˆå°è¯•ç²¾ç¡®åŒ¹é…
      for (const c of candidates) {
        if (cols.includes(c)) return c;
      }
      // å†å°è¯•å¿½ç•¥ç©ºæ ¼å’Œå¤§å°å†™çš„åŒ¹é…
      const normalizedCols = cols.map(col => String(col).replace(/\s+/g, "").toLowerCase());
      for (const c of candidates) {
        const normalized = String(c).replace(/\s+/g, "").toLowerCase();
        const index = normalizedCols.indexOf(normalized);
        if (index !== -1) {
          console.log(`å­—æ®µåŒ¹é…ï¼ˆå¿½ç•¥ç©ºæ ¼/å¤§å°å†™ï¼‰: "${c}" â†’ "${cols[index]}"`);
          return cols[index];  // è¿”å›åŸå§‹å­—æ®µå
        }
      }
      return null;
    }

    function processData(rows) {
      if (!rows || !rows.length) {
        errorEl.textContent = "Excel ä¸­æ²¡æœ‰æ•°æ®ã€‚";
        return;
      }

      const allCols = Object.keys(rows[0]);
      console.log("æ£€æµ‹åˆ°çš„è¡¨å¤´å­—æ®µ:", allCols);

      // æ ¹æ®å£¹ä¼´è¡¨æ ¼å­—æ®µè¿›è¡ŒåŒ¹é…
      const colMap = {
        title: findCol(["æ ‡é¢˜", "æ–‡ç« æ ‡é¢˜", "å†…å®¹æ ‡é¢˜"], allCols) || allCols[0],
        date: findCol(["æ—¥æœŸ", "é˜…è¯»", "å‘å¸ƒæ—¶é—´", "å‘è¡¨æ—¶é—´"], allCols),
        hour: findCol(["å°æ—¶"], allCols),
        readCount: findCol(["é˜…è¯»é‡"], allCols),
        readers: findCol(["é˜…è¯»äººæ•°"], allCols),
        officialAccount: findCol(["å…¬ä¼—å·"], allCols),
        readingGroup: findCol(["é˜…è¯»ç»„"], allCols),
        moments: findCol(["æœ‹å‹åœˆ"], allCols),
        look: findCol(["çœ‹ä¸€çœ‹", "çœ‹ä¸€çœ‹ç²¾é€‰", "çœ‹ä¸€çœ‹é˜…è¯»æ•°", "çœ‹ä¸€çœ‹é˜…è¯»", "ç²¾"], allCols),
        search: findCol(["æœä¸€æœ", "æœä¸€æœé˜…è¯»æ•°", "æœä¸€æœé˜…è¯»"], allCols),
        follows: findCol(["æ–°å¢å…³æ³¨", "é˜…è¯»åå…³æ³¨", "é˜…è¯»åå…³æ³¨äººæ•°", "å…³æ³¨äººæ•°", "æ–°å¢å…³æ³¨äººæ•°"], allCols),
        shareCount: findCol(["åˆ†äº«é‡"], allCols),
        sharers: findCol(["åˆ†äº«äººæ•°"], allCols),
        sessionShare: findCol(["ä¼šè¯åˆ†äº«"], allCols),
        officialShare: findCol(["å…¬ä¼—å·åˆ†äº«"], allCols),
        otherShare: findCol(["å…¶ä»–åˆ†äº«"], allCols),
        likes: findCol(["ç‚¹èµæ•°", "ç‚¹èµé‡"], allCols),
        dislikes: findCol(["ç‚¹è¸©æ•°"], allCols),
        tips: findCol(["æ‰“èµæ•°"], allCols),
        openRate: findCol(["æ‰“å¼€ç‡", "æ‰“å¼€ç‡(%)", "æ‰“å¼€ç‡%"], allCols),
        shareRate: findCol(["åˆ†äº«ç‡", "åˆ†äº«ç‡(%)", "åˆ†äº«ç‡%"], allCols),
        momentsOpenRate: findCol(["æœ‹å‹åœˆæ‰“", "æœ‹å‹åœˆæ‰“å¼€ç‡", "æœ‹å‹åœˆæ‰“å¼€ç‡(%)", "æœ‹å‹åœˆæ‰“å¼€ç‡%", "æœ‹å‹åœˆæ‰“å¼€"], allCols),
        readConversionRate: findCol(["é˜…è¯»è½¬åŒ–ç‡"], allCols),
        completionRate: findCol(["å®Œè¯»ç‡"], allCols),
        interactionRate: findCol(["äº’åŠ¨ç‡"], allCols),
        comments: findCol(["ç•™è¨€æ•°", "è¯„è®ºæ•°", "ç•™è¨€", "è¯„è®º"], allCols),
      };

      // è¾“å‡ºå­—æ®µåŒ¹é…ç»“æœï¼Œç”¨äºè°ƒè¯•
      console.log("å­—æ®µåŒ¹é…ç»“æœ:", colMap);
      console.log("å…³é”®å­—æ®µåŒ¹é…è¯¦æƒ…:", {
        look: colMap.look ? "âœ“ " + colMap.look : "âœ— æœªåŒ¹é…",
        momentsOpenRate: colMap.momentsOpenRate ? "âœ“ " + colMap.momentsOpenRate : "âœ— æœªåŒ¹é…ï¼ˆå°†è®¡ç®—ï¼‰",
        moments: colMap.moments ? "âœ“ " + colMap.moments : "âœ— æœªåŒ¹é…",
        readers: colMap.readers ? "âœ“ " + colMap.readers : "âœ— æœªåŒ¹é…"
      });

      // å¦‚æœå­—æ®µæœªåŒ¹é…ï¼Œå°è¯•è‡ªåŠ¨æŸ¥æ‰¾ï¼ˆåªæ‰§è¡Œä¸€æ¬¡ï¼‰
      if (!colMap.look) {
        console.warn("âš ï¸ çœ‹ä¸€çœ‹å­—æ®µæœªåŒ¹é…ï¼Œå°è¯•åœ¨æ‰€æœ‰å­—æ®µä¸­æŸ¥æ‰¾...");
        const possibleCol = allCols.find(col => {
          const colStr = String(col);
          return colStr.includes("çœ‹") || colStr.toLowerCase().includes("look");
        });
        if (possibleCol) {
          console.log("æ‰¾åˆ°å¯èƒ½çš„å­—æ®µ:", possibleCol);
          colMap.look = possibleCol;
        }
      }
      if (!colMap.momentsOpenRate) {
        console.warn("âš ï¸ æœ‹å‹åœˆæ‰“å¼€ç‡å­—æ®µæœªåŒ¹é…ï¼Œå°è¯•åœ¨æ‰€æœ‰å­—æ®µä¸­æŸ¥æ‰¾...");
        const possibleCol = allCols.find(col => {
          const colStr = String(col);
          return (colStr.includes("æœ‹å‹åœˆ") && colStr.includes("æ‰“")) ||
            (colStr.includes("æœ‹å‹åœˆ") && (colStr.includes("æ‰“å¼€") || colStr.includes("æ‰“å¼€ç‡")));
        });
        if (possibleCol) {
          console.log("æ‰¾åˆ°å¯èƒ½çš„å­—æ®µ:", possibleCol);
          colMap.momentsOpenRate = possibleCol;
        }
      }

      const data = [];
      let minDate = null;
      let maxDate = null;
      const dailyMap = {};
      const hourMap = {};

      rows.forEach((row) => {
        const title = row[colMap.title] || "";
        const date = colMap.date ? parseDate(row[colMap.date]) : null;
        const hour = colMap.hour ? num(row[colMap.hour]) : null;

        const item = {
          title,
          date,
          hour,
          readCount: num(row[colMap.readCount]),
          readers: num(row[colMap.readers]),
          officialAccount: num(row[colMap.officialAccount]),
          readingGroup: num(row[colMap.readingGroup]),
          moments: num(row[colMap.moments]),
          look: (function () {
            if (!colMap.look) {
              if (rows.indexOf(row) === 0) {
                console.warn("âš ï¸ çœ‹ä¸€çœ‹å­—æ®µä»æœªåŒ¹é…");
              }
              return 0;
            }
            const rawValue = row[colMap.look];
            const parsedValue = num(rawValue);
            if (rows.indexOf(row) === 0) {
              console.log("ç¬¬ä¸€æ¡æ•°æ®çš„çœ‹ä¸€çœ‹å­—æ®µ:", {
                fieldName: colMap.look,
                rawValue: rawValue,
                parsedValue: parsedValue
              });
            }
            return parsedValue;
          })(),
          search: (function () {
            const rawValue = colMap.search ? row[colMap.search] : null;
            const parsedValue = num(rawValue);
            if (rows.indexOf(row) === 0) {
              console.log("ç¬¬ä¸€æ¡æ•°æ®çš„æœä¸€æœå­—æ®µ:", {
                fieldName: colMap.search,
                rawValue: rawValue,
                parsedValue: parsedValue
              });
            }
            return parsedValue;
          })(),
          follows: (function () {
            const rawValue = colMap.follows ? row[colMap.follows] : null;
            const parsedValue = num(rawValue);
            // è°ƒè¯•ç¬¬ä¸€æ¡æ•°æ®
            if (rows.indexOf(row) === 0) {
              console.log("ç¬¬ä¸€æ¡æ•°æ®çš„æ–°å¢å…³æ³¨å­—æ®µ:", {
                fieldName: colMap.follows,
                rawValue: rawValue,
                parsedValue: parsedValue
              });
            }
            return parsedValue;
          })(),
          shareCount: num(row[colMap.shareCount]),
          sharers: num(row[colMap.sharers]),
          sessionShare: num(row[colMap.sessionShare]),
          officialShare: num(row[colMap.officialShare]),
          otherShare: num(row[colMap.otherShare]),
          likes: num(row[colMap.likes]),
          dislikes: num(row[colMap.dislikes]),
          tips: num(row[colMap.tips]),
          openRate: (function () {
            const rawValue = colMap.openRate ? row[colMap.openRate] : null;
            const parsedValue = pct(rawValue);
            if (rows.indexOf(row) === 0) {
              console.log("ç¬¬ä¸€æ¡æ•°æ®çš„æ‰“å¼€ç‡å­—æ®µ:", {
                fieldName: colMap.openRate,
                rawValue: rawValue,
                parsedValue: parsedValue
              });
            }
            return parsedValue;
          })(),
          shareRate: (function () {
            const rawValue = colMap.shareRate ? row[colMap.shareRate] : null;
            const parsedValue = pct(rawValue);
            if (rows.indexOf(row) === 0) {
              console.log("ç¬¬ä¸€æ¡æ•°æ®çš„åˆ†äº«ç‡å­—æ®µ:", {
                fieldName: colMap.shareRate,
                rawValue: rawValue,
                parsedValue: parsedValue
              });
            }
            return parsedValue;
          })(),
          readConversionRate: pct(row[colMap.readConversionRate]),
          completionRate: pct(row[colMap.completionRate]),
          interactionRate: pct(row[colMap.interactionRate]),
          comments: num(row[colMap.comments]),
          // æœ‹å‹åœˆæ‰“å¼€ç‡ï¼šä¼˜å…ˆä½¿ç”¨è¡¨å¤´å­—æ®µï¼Œå¦‚æœæ²¡æœ‰åˆ™è®¡ç®—
          momentsOpenRate: (function () {
            // å¦‚æœæœ‰ç°æˆçš„å­—æ®µï¼Œç›´æ¥ä½¿ç”¨
            if (colMap.momentsOpenRate) {
              const rawValue = row[colMap.momentsOpenRate];
              const parsedValue = pct(rawValue);
              if (rows.indexOf(row) === 0) {
                console.log("ç¬¬ä¸€æ¡æ•°æ®çš„æœ‹å‹åœˆæ‰“å¼€ç‡ï¼ˆç›´æ¥è¯»å–ï¼‰:", {
                  fieldName: colMap.momentsOpenRate,
                  rawValue: rawValue,
                  parsedValue: parsedValue
                });
              }
              return parsedValue;
            }
            // å¦‚æœå­—æ®µæœªåŒ¹é…ï¼Œå°è¯•è®¡ç®—
            if (rows.indexOf(row) === 0) {
              console.warn("âš ï¸ æœ‹å‹åœˆæ‰“å¼€ç‡å­—æ®µæœªåŒ¹é…ï¼Œå°†ä½¿ç”¨è®¡ç®—å€¼");
            }
            // è®¡ç®—ï¼šæœ‹å‹åœˆé˜…è¯»æ•° / é˜…è¯»äººæ•° * 100
            const readers = num(row[colMap.readers]);
            const moments = num(row[colMap.moments]);
            const rate = readers > 0 ? (moments / readers * 100) : 0;
            if (rows.indexOf(row) === 0) {
              console.log("ç¬¬ä¸€æ¡æ•°æ®çš„æœ‹å‹åœˆæ‰“å¼€ç‡ï¼ˆè®¡ç®—ï¼‰:", {
                readersField: colMap.readers,
                readersValue: readers,
                momentsField: colMap.moments,
                momentsValue: moments,
                calculatedRate: rate
              });
            }
            return rate;
          })(),
          // è®¡ç®—ç•™è¨€ç‡ = ç•™è¨€æ•° / é˜…è¯»äººæ•° * 100
          commentRate: (function () {
            const readers = num(row[colMap.readers]);
            return (readers > 0 && colMap.comments) ? (num(row[colMap.comments]) / readers * 100) : 0;
          })(),
        };

        data.push(item);

        if (date) {
          if (!minDate || date < minDate) minDate = date;
          if (!maxDate || date > maxDate) maxDate = date;

          const dayStr = formatDate(date);
          dailyMap[dayStr] = (dailyMap[dayStr] || 0) + 1;

          if (hour !== null && hour >= 0 && hour < 24) {
            hourMap[hour] = (hourMap[hour] || 0) + 1;
          }
        }
      });

      if (minDate && maxDate) {
        document.getElementById("dateRange").innerHTML =
          `æ—¶é—´èŒƒå›´ï¼š${formatDate(minDate)} ~ ${formatDate(maxDate)}` +
          `<span class="tag">ç”¨äºæ•°æ®åˆ†æå±•ç¤º</span>`;
      }

      renderSummary(data);
      renderTopRead(data);
      renderReadShare(data);
      renderTopLikes(data);
      renderTopShare(data);
      renderOpenRate(data);

      // è°ƒè¯•ï¼šè¾“å‡ºæ•°æ®æ ·æœ¬
      if (data.length > 0) {
        console.log("æ•°æ®æ ·æœ¬ï¼ˆç¬¬ä¸€æ¡ï¼‰:", data[0]);
        console.log("æ•°æ®æ€»æ•°:", data.length);
      }

      renderTop5Tables(data);
      renderDetailTable(data);
    }

    function renderSummary(data) {
      document.getElementById("summaryCards").style.display = "grid";

      const total = data.length;
      const totalReaders = data.reduce((s, r) => s + r.readers, 0);
      const totalReadCount = data.reduce((s, r) => s + r.readCount, 0);
      const totalShareCount = data.reduce((s, r) => s + r.shareCount, 0);
      const totalLikes = data.reduce((s, r) => s + r.likes, 0);
      const totalFollows = data.reduce((s, r) => s + r.follows, 0);

      const openRates = data.map((r) => r.openRate).filter((v) => v > 0);
      const avgOpenRate =
        openRates.length > 0
          ? (openRates.reduce((a, b) => a + b, 0) / openRates.length).toFixed(2)
          : "0.00";

      const shareRates = data.map((r) => r.shareRate).filter((v) => v > 0);
      const avgShareRate =
        shareRates.length > 0
          ? (shareRates.reduce((a, b) => a + b, 0) / shareRates.length).toFixed(2)
          : "0.00";

      document.getElementById("totalArticles").textContent = total;
      document.getElementById("totalReaders").textContent = totalReaders.toLocaleString();
      document.getElementById("totalReadCount").textContent = totalReadCount.toLocaleString();
      document.getElementById("totalShareCount").textContent = totalShareCount.toLocaleString();
      document.getElementById("totalLikes").textContent = totalLikes.toLocaleString();
      document.getElementById("totalFollows").textContent = totalFollows.toLocaleString();
      document.getElementById("avgOpenRate").textContent = avgOpenRate + "%";
      document.getElementById("avgShareRate").textContent = avgShareRate + "%";
    }

    function renderReadSource(data) {
      const officialAccount = data.reduce((s, r) => s + r.officialAccount, 0);
      const readingGroup = data.reduce((s, r) => s + r.readingGroup, 0);
      const moments = data.reduce((s, r) => s + r.moments, 0);
      const look = data.reduce((s, r) => s + r.look, 0);
      const search = data.reduce((s, r) => s + r.search, 0);

      Plotly.newPlot(
        "readSourceChart",
        [
          {
            x: ["å…¬ä¼—å·", "é˜…è¯»ç»„", "æœ‹å‹åœˆ", "çœ‹ä¸€çœ‹", "æœä¸€æœ"],
            y: [officialAccount, readingGroup, moments, look, search],
            type: "bar",
          },
        ],
        { margin: { t: 20, r: 10, b: 40, l: 40 } }
      );
    }

    function renderTopRead(data) {
      const top = data
        .slice()
        .sort((a, b) => b.readers - a.readers)
        .slice(0, 10);

      Plotly.newPlot(
        "topReadChart",
        [
          {
            x: top.map((x) => x.title || "æœªå‘½å"),
            y: top.map((x) => x.readers),
            type: "bar",
          },
        ],
        { margin: { b: 120 } }
      );
    }

    function renderReadShare(data) {
      Plotly.newPlot(
        "readShareScatter",
        [
          {
            x: data.map((x) => x.readers),
            y: data.map((x) => x.shareCount),
            mode: "markers",
            type: "scatter",
            text: data.map((x) => x.title || "æœªå‘½å"),
          },
        ],
        {
          xaxis: { title: "é˜…è¯»äººæ•°" },
          yaxis: { title: "åˆ†äº«é‡" },
        }
      );
    }

    function renderTopLikes(data) {
      const top = data
        .slice()
        .sort((a, b) => b.likes - a.likes)
        .slice(0, 10);

      Plotly.newPlot(
        "topLikesChart",
        [
          {
            x: top.map((x) => x.title || "æœªå‘½å"),
            y: top.map((x) => x.likes),
            type: "bar",
          },
        ],
        { margin: { b: 120 } }
      );
    }

    function renderTopShare(data) {
      const top = data
        .slice()
        .sort((a, b) => b.shareCount - a.shareCount)
        .slice(0, 10);

      Plotly.newPlot(
        "topShareChart",
        [
          {
            x: top.map((x) => x.title || "æœªå‘½å"),
            y: top.map((x) => x.shareCount),
            type: "bar",
          },
        ],
        { margin: { b: 120 } }
      );
    }

    function renderOpenRate(data) {
      const list = data
        .filter((x) => x.openRate > 0)
        .sort((a, b) => b.openRate - a.openRate)
        .slice(0, 20);

      Plotly.newPlot(
        "openRateChart",
        [
          {
            x: list.map((x) => x.title || "æœªå‘½å"),
            y: list.map((x) => x.openRate),
            type: "bar",
          },
        ],
        { margin: { b: 120 }, yaxis: { title: "æ‰“å¼€ç‡ (%)" } }
      );
    }

    function renderShareRate(data) {
      console.log("åˆ†äº«ç‡æ•°æ®ç»Ÿè®¡:", {
        total: data.length,
        hasData: data.filter(item => item.shareRate > 0).length,
        maxValue: data.length > 0 ? Math.max(...data.map(item => item.shareRate)) : 0,
        minValue: data.length > 0 ? Math.min(...data.map(item => item.shareRate)) : 0,
        sampleValues: data.slice(0, 5).map(item => ({ title: item.title, shareRate: item.shareRate }))
      });

      const list = data
        .filter((x) => x.shareRate > 0)
        .sort((a, b) => b.shareRate - a.shareRate)
        .slice(0, 20);

      if (list.length === 0) {
        console.warn("åˆ†äº«ç‡æ•°æ®ä¸ºç©ºï¼Œå¯èƒ½å­—æ®µåŒ¹é…å¤±è´¥æˆ–æ‰€æœ‰æ•°æ®éƒ½æ˜¯0");
        // å³ä½¿æ²¡æœ‰æ•°æ®ï¼Œä¹Ÿæ˜¾ç¤ºä¸€ä¸ªç©ºå›¾è¡¨ï¼Œé¿å…æŠ¥é”™
        Plotly.newPlot(
          "shareRateChart",
          [{ x: [], y: [], type: "bar" }],
          { margin: { b: 120 }, yaxis: { title: "åˆ†äº«ç‡ (%)" } }
        );
        return;
      }

      Plotly.newPlot(
        "shareRateChart",
        [
          {
            x: list.map((x) => x.title || "æœªå‘½å"),
            y: list.map((x) => x.shareRate),
            type: "bar",
          },
        ],
        { margin: { b: 120 }, yaxis: { title: "åˆ†äº«ç‡ (%)" } }
      );
    }

    function renderDailyChart(dailyMap) {
      const dates = Object.keys(dailyMap).sort();
      const counts = dates.map((d) => dailyMap[d]);

      Plotly.newPlot(
        "dailyChart",
        [{ x: dates, y: counts, type: "bar" }],
        { margin: { t: 20, r: 10, b: 60, l: 40 } }
      );
    }

    function renderHourChart(hourMap) {
      const hours = [];
      const counts = [];
      for (let h = 0; h < 24; h++) {
        hours.push(h);
        counts.push(hourMap[h] || 0);
      }

      Plotly.newPlot(
        "hourChart",
        [{ x: hours, y: counts, type: "bar" }],
        { margin: { t: 20, r: 10, b: 40, l: 40 }, xaxis: { dtick: 1 } }
      );
    }

    function renderTop5Tables(data) {
      if (!data || data.length === 0) {
        console.warn("renderTop5Tables: æ•°æ®ä¸ºç©º");
        return;
      }

      // 1. é˜…è¯»é‡ TOP 5 - ä¸è¿‡æ»¤ï¼Œç›´æ¥å–å‰5
      const topReadCount = data
        .slice()
        .sort((a, b) => b.readCount - a.readCount)
        .slice(0, 5);
      console.log("é˜…è¯»é‡ TOP 5:", topReadCount.map(item => ({ title: item.title, readCount: item.readCount })));
      renderTop5Table("topReadCountTable", topReadCount, "é˜…è¯»é‡", (item) => item.readCount.toLocaleString());

      // 2. æœä¸€æœ TOP 5 - æ”¾å®½æ¡ä»¶ï¼Œå…è®¸ä¸º0
      const topSearch = data
        .slice()
        .filter((item) => item.search > 0)  // è¿‡æ»¤æ‰0å€¼
        .sort((a, b) => b.search - a.search)
        .slice(0, 5);
      console.log("æœä¸€æœ TOP 5:", topSearch.map(item => ({ title: item.title, search: item.search })));
      console.log("æœä¸€æœæ•°æ®ç»Ÿè®¡:", {
        total: data.length,
        hasData: data.filter(item => item.search > 0).length,
        maxValue: data.length > 0 ? Math.max(...data.map(item => item.search)) : 0,
        sampleValues: data.slice(0, 3).map(item => ({ title: item.title, search: item.search }))
      });
      renderTop5Table("topSearchTable", topSearch, "æœä¸€æœé˜…è¯»æ•°", (item) => item.search.toLocaleString());

      // 3. çœ‹ä¸€çœ‹ç²¾é€‰ TOP 5 - åªæ˜¾ç¤ºæœ‰æ•°æ®çš„ï¼ˆ>0ï¼‰
      const topLook = data
        .slice()
        .filter((item) => item.look > 0)  // è¿‡æ»¤æ‰0å€¼
        .sort((a, b) => b.look - a.look)
        .slice(0, 5);
      console.log("çœ‹ä¸€çœ‹ TOP 5:", topLook.map(item => ({ title: item.title, look: item.look })));
      console.log("çœ‹ä¸€çœ‹æ•°æ®ç»Ÿè®¡:", {
        total: data.length,
        hasData: data.filter(item => item.look > 0).length,
        maxValue: data.length > 0 ? Math.max(...data.map(item => item.look)) : 0,
        allValues: data.map(item => item.look).slice(0, 10),  // æ˜¾ç¤ºå‰10æ¡çš„å€¼
        sampleValues: data.slice(0, 5).map(item => ({ title: item.title, look: item.look }))
      });
      if (topLook.length === 0) {
        console.warn("âš ï¸ çœ‹ä¸€çœ‹ TOP 5 ä¸ºç©ºï¼Œå¯èƒ½åŸå› ï¼šå­—æ®µåŒ¹é…å¤±è´¥æˆ–æ‰€æœ‰æ•°æ®éƒ½æ˜¯0");
      }
      renderTop5Table("topLookTable", topLook, "çœ‹ä¸€çœ‹é˜…è¯»æ•°", (item) => item.look.toLocaleString());

      // 4. åˆ†äº«é‡ TOP 5 - åªæ˜¾ç¤ºæœ‰æ•°æ®çš„ï¼ˆ>0ï¼‰
      const topShareCount = data
        .slice()
        .filter((item) => item.shareCount > 0)  // è¿‡æ»¤æ‰0å€¼
        .sort((a, b) => b.shareCount - a.shareCount)
        .slice(0, 5);
      console.log("åˆ†äº«é‡ TOP 5:", topShareCount.map(item => ({ title: item.title, shareCount: item.shareCount })));
      console.log("åˆ†äº«é‡æ•°æ®ç»Ÿè®¡:", {
        total: data.length,
        hasData: data.filter(item => item.shareCount > 0).length,
        maxValue: data.length > 0 ? Math.max(...data.map(item => item.shareCount)) : 0,
        sampleValues: data.slice(0, 3).map(item => ({ title: item.title, shareCount: item.shareCount }))
      });
      renderTop5Table("topShareCountTable", topShareCount, "åˆ†äº«é‡", (item) => item.shareCount.toLocaleString());

      // 5. æ‰“å¼€ç‡ TOP 5 - åªæ˜¾ç¤ºæœ‰æ•°æ®çš„ï¼ˆ>0ï¼‰
      const topOpenRate = data
        .slice()
        .filter((item) => item.openRate > 0)  // è¿‡æ»¤æ‰0å€¼
        .sort((a, b) => b.openRate - a.openRate)
        .slice(0, 5);
      console.log("æ‰“å¼€ç‡ TOP 5:", topOpenRate.map(item => ({ title: item.title, openRate: item.openRate })));
      console.log("æ‰“å¼€ç‡æ•°æ®ç»Ÿè®¡:", {
        total: data.length,
        hasData: data.filter(item => item.openRate > 0).length,
        maxValue: data.length > 0 ? Math.max(...data.map(item => item.openRate)) : 0,
        sampleValues: data.slice(0, 3).map(item => ({ title: item.title, openRate: item.openRate }))
      });
      renderTop5Table("topOpenRateTable", topOpenRate, "æ‰“å¼€ç‡", (item) => item.openRate.toFixed(2) + "%");

      // 6. æœ‹å‹åœˆæ‰“å¼€ç‡ TOP 5 - åªæ˜¾ç¤ºæœ‰æ•°æ®çš„ï¼ˆ>0ï¼‰
      const topMomentsOpenRate = data
        .slice()
        .filter((item) => item.momentsOpenRate > 0)  // è¿‡æ»¤æ‰0å€¼
        .sort((a, b) => b.momentsOpenRate - a.momentsOpenRate)
        .slice(0, 5);
      console.log("æœ‹å‹åœˆæ‰“å¼€ç‡ TOP 5:", topMomentsOpenRate.map(item => ({ title: item.title, momentsOpenRate: item.momentsOpenRate })));
      console.log("æœ‹å‹åœˆæ‰“å¼€ç‡æ•°æ®ç»Ÿè®¡:", {
        total: data.length,
        hasData: data.filter(item => item.momentsOpenRate > 0).length,
        maxValue: data.length > 0 ? Math.max(...data.map(item => item.momentsOpenRate)) : 0,
        allValues: data.map(item => item.momentsOpenRate).slice(0, 10),  // æ˜¾ç¤ºå‰10æ¡çš„å€¼
        sampleValues: data.slice(0, 5).map(item => ({
          title: item.title,
          momentsOpenRate: item.momentsOpenRate,
          moments: item.moments,
          readers: item.readers
        }))
      });
      if (topMomentsOpenRate.length === 0) {
        console.warn("âš ï¸ æœ‹å‹åœˆæ‰“å¼€ç‡ TOP 5 ä¸ºç©ºï¼Œå¯èƒ½åŸå› ï¼šå­—æ®µåŒ¹é…å¤±è´¥æˆ–æ‰€æœ‰æ•°æ®éƒ½æ˜¯0");
      }
      renderTop5Table("topMomentsOpenRateTable", topMomentsOpenRate, "æœ‹å‹åœˆæ‰“å¼€ç‡", (item) => item.momentsOpenRate.toFixed(2) + "%");

      // 7. ç•™è¨€ç‡ TOP 5 - åªæ˜¾ç¤ºæœ‰æ•°æ®çš„ï¼ˆ>0ï¼‰
      const topCommentRate = data
        .slice()
        .filter((item) => item.commentRate > 0)  // è¿‡æ»¤æ‰0å€¼
        .sort((a, b) => b.commentRate - a.commentRate)
        .slice(0, 5);
      console.log("ç•™è¨€ç‡ TOP 5:", topCommentRate.map(item => ({ title: item.title, commentRate: item.commentRate })));
      console.log("ç•™è¨€ç‡æ•°æ®ç»Ÿè®¡:", {
        total: data.length,
        hasData: data.filter(item => item.commentRate > 0).length,
        maxValue: data.length > 0 ? Math.max(...data.map(item => item.commentRate)) : 0,
        sampleValues: data.slice(0, 3).map(item => ({ title: item.title, commentRate: item.commentRate }))
      });
      renderTop5Table("topCommentRateTable", topCommentRate, "ç•™è¨€ç‡", (item) => item.commentRate.toFixed(2) + "%");

      // 8. é˜…è¯»åå…³æ³¨ TOP 5 - åªæ˜¾ç¤ºæœ‰æ•°æ®çš„ï¼ˆ>0ï¼‰
      const topFollows = data
        .slice()
        .filter((item) => item.follows > 0)  // è¿‡æ»¤æ‰0å€¼
        .sort((a, b) => b.follows - a.follows)
        .slice(0, 5);
      console.log("é˜…è¯»åå…³æ³¨ TOP 5:", topFollows.map(item => ({ title: item.title, follows: item.follows })));
      console.log("é˜…è¯»åå…³æ³¨æ•°æ®ç»Ÿè®¡:", {
        total: data.length,
        hasData: data.filter(item => item.follows > 0).length,
        maxValue: data.length > 0 ? Math.max(...data.map(item => item.follows)) : 0,
        sampleValues: data.slice(0, 3).map(item => ({ title: item.title, follows: item.follows }))
      });
      renderTop5Table("topFollowsTable", topFollows, "æ–°å¢å…³æ³¨", (item) => item.follows.toLocaleString());
    }

    function renderTop5Table(containerId, list, valueLabel, valueFormatter) {
      const container = document.getElementById(containerId);
      if (!list || !list.length) {
        container.innerHTML = "<div style='font-size:12px;color:#6b7280;'>æš‚æ— æ•°æ®</div>";
        return;
      }

      let html = "<table class='data-table'><thead><tr>";
      html += "<th>æ’å</th><th>æ ‡é¢˜</th><th>æ—¥æœŸ</th><th>" + valueLabel + "</th><th>é˜…è¯»äººæ•°</th>";
      html += "</tr></thead><tbody>";

      list.forEach((row, index) => {
        html += "<tr>";
        html += `<td>${index + 1}</td>`;
        html += `<td>${escapeHtml(row.title || "æœªå‘½å")}</td>`;
        html += `<td>${row.date ? formatDate(row.date) : ""}</td>`;
        html += `<td><strong>${valueFormatter(row)}</strong></td>`;
        html += `<td>${row.readers.toLocaleString()}</td>`;
        html += "</tr>";
      });

      html += "</tbody></table>";
      container.innerHTML = html;
    }

    function renderDetailTable(data) {
      const top = data
        .slice()
        .sort((a, b) => b.readers - a.readers)
        .slice(0, 50);

      let html = "<table class='data-table'><thead><tr>";
      const headers = [
        "æ ‡é¢˜",
        "æ—¥æœŸ",
        "é˜…è¯»äººæ•°",
        "é˜…è¯»é‡",
        "åˆ†äº«é‡",
        "ç‚¹èµæ•°",
        "æ–°å¢å…³æ³¨",
        "æ‰“å¼€ç‡",
        "åˆ†äº«ç‡",
      ];
      html += headers.map((h) => `<th>${h}</th>`).join("");
      html += "</tr></thead><tbody>";

      top.forEach((row) => {
        html += "<tr>";
        html += `<td>${escapeHtml(row.title || "")}</td>`;
        html += `<td>${row.date ? formatDate(row.date) : ""}</td>`;
        html += `<td>${row.readers}</td>`;
        html += `<td>${row.readCount}</td>`;
        html += `<td>${row.shareCount}</td>`;
        html += `<td>${row.likes}</td>`;
        html += `<td>${row.follows}</td>`;
        html += `<td>${row.openRate.toFixed(2)}%</td>`;
        html += `<td>${row.shareRate.toFixed(2)}%</td>`;
        html += "</tr>";
      });

      html += "</tbody></table>";
      document.getElementById("detailTable").innerHTML = html;
    }

  </script>

  <!-- å…¬å…±æ¨¡å— -->
  <script src="js/utils.js"></script>
  <script src="js/nav.js"></script>
  <script src="js/auth.js"></script>
  
  <script>
    // åˆå§‹åŒ–å¯¼èˆª
    renderNav({
      title: 'å£¹ä¼´æ•°æ®åˆ†æ',
      icon: 'ğŸ“Š',
      showFileInput: true,
      fileAccept: '.xlsx,.xls,.csv',
      fileLabel: 'ğŸ“¤ é€‰æ‹© Excel',
      onFileChange: (e) => {
        const file = e.target.files[0];
        if (file) handleFile(file);
      }
    });

    // åˆå§‹åŒ–æˆæƒ
    initAuth('yiban-analysis');
  </script>
</body>

</html>